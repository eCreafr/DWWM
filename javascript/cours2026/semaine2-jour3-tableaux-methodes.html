<!doctype html>
<html lang="fr">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Semaine 2 - Jour 3 | Tableaux - Partie 2</title>
        <link rel="stylesheet" href="../css/froggie.css" />
        <style>
            .demo-container {
                max-width: 1200px;
                margin: 40px auto;
                padding: 20px;
                font-family: Arial, sans-serif;
            }
            .demo-title {
                text-align: center;
                font-size: 2.5em;
                margin-bottom: 20px;
                color: #2c3e50;
            }
            .demo-intro {
                background: #ecf0f1;
                padding: 20px;
                border-radius: 10px;
                margin-bottom: 40px;
                line-height: 1.6;
            }
            .demo-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                gap: 30px;
                margin-bottom: 40px;
            }
            .demo-item {
                border: 2px solid #f093fb;
                border-radius: 10px;
                padding: 20px;
                background: white;
                box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            }
            .demo-item h2 {
                margin-top: 0;
                color: #f093fb;
                font-size: 1.5em;
            }
            .code-example {
                background: #2c3e50;
                color: #ecf0f1;
                padding: 15px;
                border-radius: 5px;
                font-family: 'Courier New', monospace;
                font-size: 0.9em;
                margin: 15px 0;
                overflow-x: auto;
            }
            .highlight {
                color: #f39c12;
                font-weight: bold;
            }
            .keyword {
                color: #e74c3c;
            }
            .string {
                color: #2ecc71;
            }
            .comment {
                color: #95a5a6;
                font-style: italic;
            }

            /* Console JavaScript interactive */
            .js-console {
                background: #1e1e1e;
                border-radius: 10px;
                padding: 20px;
                margin: 30px 0;
                box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            }
            .js-console-header {
                color: #f39c12;
                font-weight: bold;
                margin-bottom: 15px;
                font-size: 1.1em;
                display: flex;
                align-items: center;
                gap: 10px;
            }
            .js-console-editor {
                background: #2d2d2d;
                border: 1px solid #444;
                border-radius: 5px;
                padding: 15px;
                margin-bottom: 15px;
            }
            .js-console-editor textarea {
                width: 100%;
                background: transparent;
                border: none;
                color: #f8f8f2;
                font-family: 'Courier New', monospace;
                font-size: 0.95em;
                resize: vertical;
                min-height: 80px;
                outline: none;
            }
            .js-console-output {
                background: #000;
                border: 1px solid #444;
                border-radius: 5px;
                padding: 15px;
                color: #0f0;
                font-family: 'Courier New', monospace;
                font-size: 0.9em;
                min-height: 60px;
                max-height: 300px;
                overflow-y: auto;
                white-space: pre-wrap;
            }
            .js-console-output .error {
                color: #e74c3c;
            }
            .js-console-output .warning {
                color: #f39c12;
            }
            .js-console-buttons {
                display: flex;
                gap: 10px;
                margin-bottom: 15px;
            }
            .btn-execute {
                background: #2ecc71;
                color: white;
                border: none;
                padding: 10px 20px;
                border-radius: 5px;
                cursor: pointer;
                font-weight: bold;
                transition: background 0.3s;
            }
            .btn-execute:hover {
                background: #27ae60;
            }
            .btn-clear {
                background: #e74c3c;
                color: white;
                border: none;
                padding: 10px 20px;
                border-radius: 5px;
                cursor: pointer;
                font-weight: bold;
                transition: background 0.3s;
            }
            .btn-clear:hover {
                background: #c0392b;
            }
        </style>
    </head>
    <body>
        <div class="demo-container">
            <h1 class="demo-title">Semaine 2 - Jour 3 : Tableaux - Partie 2 (Méthodes avancées)</h1>

            <div class="demo-intro">
                <h3>Méthodes de tableaux puissantes</h3>
                <p>
                    JavaScript offre des <strong>méthodes de tableaux</strong> très puissantes qui permettent de transformer,
                    filtrer et manipuler des données de manière élégante et efficace.
                </p>
                <p>
                    <strong>Ces méthodes sont essentielles</strong> pour la programmation moderne JavaScript. Elles remplacent
                    souvent les boucles for traditionnelles et rendent le code plus lisible.
                </p>
                <p>
                    <strong>Concept clé :</strong> La plupart de ces méthodes prennent une <strong>fonction callback</strong>
                    en paramètre, qui sera exécutée pour chaque élément du tableau.
                </p>
            </div>

            <!-- Concepts de base -->
            <div class="demo-grid">
                <div class="demo-item">
                    <h2>1. map() - Transformer</h2>
                    <p>
                        <strong>map()</strong> crée un nouveau tableau en appliquant une fonction à chaque élément.
                        Utilise-le pour <strong>transformer</strong> des données.
                    </p>
                    <div class="code-example">
                        <span class="keyword">let</span> nombres = [<span class="highlight">1</span>, <span class="highlight">2</span>, <span class="highlight">3</span>, <span class="highlight">4</span>, <span class="highlight">5</span>];<br /><br />

                        <span class="comment">// Doubler chaque nombre</span><br />
                        <span class="keyword">let</span> doubles = nombres.<span class="highlight">map</span>(n => n * <span class="highlight">2</span>);<br />
                        console.<span class="highlight">log</span>(doubles); <span class="comment">// [2, 4, 6, 8, 10]</span><br /><br />

                        <span class="comment">// Exemple pratique : prix avec TVA</span><br />
                        <span class="keyword">let</span> prixHT = [<span class="highlight">100</span>, <span class="highlight">200</span>, <span class="highlight">50</span>];<br />
                        <span class="keyword">let</span> prixTTC = prixHT.<span class="highlight">map</span>(p => p * <span class="highlight">1.20</span>);<br />
                        console.<span class="highlight">log</span>(prixTTC); <span class="comment">// [120, 240, 60]</span>
                    </div>
                </div>

                <div class="demo-item">
                    <h2>2. filter() - Filtrer</h2>
                    <p>
                        <strong>filter()</strong> crée un nouveau tableau avec uniquement les éléments qui passent un test.
                        Retourne <strong>true</strong> pour garder l'élément, <strong>false</strong> pour l'exclure.
                    </p>
                    <div class="code-example">
                        <span class="keyword">let</span> nombres = [<span class="highlight">1</span>, <span class="highlight">2</span>, <span class="highlight">3</span>, <span class="highlight">4</span>, <span class="highlight">5</span>, <span class="highlight">6</span>];<br /><br />

                        <span class="comment">// Garder seulement les nombres pairs</span><br />
                        <span class="keyword">let</span> pairs = nombres.<span class="highlight">filter</span>(n => n % <span class="highlight">2</span> === <span class="highlight">0</span>);<br />
                        console.<span class="highlight">log</span>(pairs); <span class="comment">// [2, 4, 6]</span><br /><br />

                        <span class="comment">// Exemple : notes supérieures à 10</span><br />
                        <span class="keyword">let</span> notes = [<span class="highlight">8</span>, <span class="highlight">12</span>, <span class="highlight">15</span>, <span class="highlight">9</span>, <span class="highlight">18</span>];<br />
                        <span class="keyword">let</span> admis = notes.<span class="highlight">filter</span>(n => n >= <span class="highlight">10</span>);<br />
                        console.<span class="highlight">log</span>(admis); <span class="comment">// [12, 15, 18]</span>
                    </div>
                </div>

                <div class="demo-item">
                    <h2>3. reduce() - Réduire</h2>
                    <p>
                        <strong>reduce()</strong> réduit un tableau à une seule valeur en appliquant une fonction qui combine les éléments.
                        Très utile pour calculer des sommes, moyennes, etc.
                    </p>
                    <div class="code-example">
                        <span class="keyword">let</span> nombres = [<span class="highlight">1</span>, <span class="highlight">2</span>, <span class="highlight">3</span>, <span class="highlight">4</span>, <span class="highlight">5</span>];<br /><br />

                        <span class="comment">// Calculer la somme</span><br />
                        <span class="keyword">let</span> somme = nombres.<span class="highlight">reduce</span>((acc, n) => acc + n, <span class="highlight">0</span>);<br />
                        console.<span class="highlight">log</span>(somme); <span class="comment">// 15</span><br /><br />

                        <span class="comment">// Calculer le produit</span><br />
                        <span class="keyword">let</span> produit = nombres.<span class="highlight">reduce</span>((acc, n) => acc * n, <span class="highlight">1</span>);<br />
                        console.<span class="highlight">log</span>(produit); <span class="comment">// 120</span><br /><br />

                        <span class="comment">// acc = accumulateur, n = nombre actuel</span>
                    </div>
                </div>

                <div class="demo-item">
                    <h2>4. Autres méthodes utiles</h2>
                    <p>
                        <strong>find()</strong> trouve un élément • <strong>sort()</strong> trie •
                        <strong>slice()</strong> découpe • <strong>join()</strong> concatène
                    </p>
                    <div class="code-example">
                        <span class="keyword">let</span> nombres = [<span class="highlight">5</span>, <span class="highlight">2</span>, <span class="highlight">8</span>, <span class="highlight">1</span>, <span class="highlight">9</span>];<br /><br />

                        <span class="comment">// find() - trouve le premier > 5</span><br />
                        <span class="keyword">let</span> trouve = nombres.<span class="highlight">find</span>(n => n > <span class="highlight">5</span>);<br />
                        console.<span class="highlight">log</span>(trouve); <span class="comment">// 8</span><br /><br />

                        <span class="comment">// sort() - trier (modifie l'original !)</span><br />
                        nombres.<span class="highlight">sort</span>((a, b) => a - b);<br />
                        console.<span class="highlight">log</span>(nombres); <span class="comment">// [1, 2, 5, 8, 9]</span><br /><br />

                        <span class="comment">// slice() - extraire une partie</span><br />
                        <span class="keyword">let</span> extrait = nombres.<span class="highlight">slice</span>(<span class="highlight">1</span>, <span class="highlight">3</span>);<br />
                        console.<span class="highlight">log</span>(extrait); <span class="comment">// [2, 5]</span>
                    </div>
                </div>
            </div>

            <!-- Console interactive -->
            <div class="js-console">
                <div class="js-console-header">
                    Console JavaScript Interactive - Testez les méthodes de tableaux !
                </div>
                <div class="js-console-editor">
                    <textarea id="js-input" placeholder="Écrivez votre code JavaScript ici..."></textarea>
                </div>
                <div class="js-console-buttons">
                    <button class="btn-execute" onclick="executeCode()">Exécuter (Ctrl + Enter)</button>
                    <button class="btn-clear" onclick="clearConsole()">Effacer</button>
                </div>
                <div class="js-console-output" id="js-output">Prêt à exécuter votre code...</div>
            </div>

            <!-- Exemples pratiques -->
            <div style="background: #e8f4f8; padding: 25px; border-radius: 10px; margin: 30px 0">
                <h2 style="color: #2c3e50; text-align: center; margin-top: 0">Exemples pratiques</h2>
                <div class="code-example">
                    <span class="comment">// Traitement de données d'étudiants</span><br />
                    <span class="keyword">let</span> notes = [<span class="highlight">12</span>, <span class="highlight">15</span>, <span class="highlight">8</span>, <span class="highlight">18</span>, <span class="highlight">9</span>, <span class="highlight">14</span>, <span class="highlight">16</span>];<br /><br />

                    <span class="comment">// Filtrer les notes >= 10</span><br />
                    <span class="keyword">let</span> admis = notes.<span class="highlight">filter</span>(n => n >= <span class="highlight">10</span>);<br />
                    console.<span class="highlight">log</span>(<span class="string">'Notes admis:'</span>, admis);<br /><br />

                    <span class="comment">// Calculer la moyenne</span><br />
                    <span class="keyword">let</span> moyenne = notes.<span class="highlight">reduce</span>((acc, n) => acc + n, <span class="highlight">0</span>) / notes.<span class="highlight">length</span>;<br />
                    console.<span class="highlight">log</span>(<span class="string">'Moyenne:'</span>, moyenne.<span class="highlight">toFixed</span>(<span class="highlight">2</span>));<br /><br />

                    <span class="comment">// Ajouter 2 points bonus à chaque note</span><br />
                    <span class="keyword">let</span> avecBonus = notes.<span class="highlight">map</span>(n => <span class="highlight">Math.min</span>(n + <span class="highlight">2</span>, <span class="highlight">20</span>));<br />
                    console.<span class="highlight">log</span>(<span class="string">'Avec bonus:'</span>, avecBonus);<br /><br />

                    <span class="comment">// Chaîner plusieurs méthodes</span><br />
                    <span class="keyword">let</span> resultat = notes<br />
                    &nbsp;&nbsp;.<span class="highlight">filter</span>(n => n >= <span class="highlight">10</span>) <span class="comment">// Garder >= 10</span><br />
                    &nbsp;&nbsp;.<span class="highlight">map</span>(n => n * <span class="highlight">2</span>) <span class="comment">// Doubler</span><br />
                    &nbsp;&nbsp;.<span class="highlight">reduce</span>((acc, n) => acc + n, <span class="highlight">0</span>); <span class="comment">// Sommer</span><br />
                    console.<span class="highlight">log</span>(<span class="string">'Résultat chaîné:'</span>, resultat);
                </div>
                <p style="text-align: center; margin-top: 20px">
                    <strong>Copiez ces exemples dans la console interactive ci-dessus !</strong>
                </p>
            </div>
        </div>

        <!-- Zone Froggiesplaining -->
        <div class="froggiesplaining">
            <span> Froggiesplaining :</span>
            <p>
                <br />
                <strong>Objectifs de ce cours :</strong><br />
                ✅ Maîtriser map() pour transformer des données<br />
                ✅ Utiliser filter() pour sélectionner des éléments<br />
                ✅ Comprendre reduce() pour calculer des agrégations<br />
                ✅ Découvrir find(), sort(), slice(), join()<br />
                ✅ Chaîner plusieurs méthodes pour des traitements complexes<br /><br />

                <strong>Points clés à retenir :</strong><br />
                • <strong>map()</strong> = transformer chaque élément (retourne nouveau tableau)<br />
                • <strong>filter()</strong> = sélectionner certains éléments (retourne nouveau tableau)<br />
                • <strong>reduce()</strong> = réduire à une seule valeur (somme, moyenne, etc.)<br />
                • <strong>find()</strong> = trouver le premier élément qui correspond<br />
                • Ces méthodes ne modifient PAS le tableau original (sauf sort)<br />
                • On peut chaîner les méthodes : <code>array.filter().map().reduce()</code><br /><br />

                <strong>Exercice pratique :</strong><br />
                1. Créez un tableau de prix : [19.99, 29.99, 9.99, 49.99, 14.99]<br />
                2. Utilisez map() pour ajouter 20% de TVA à chaque prix<br />
                3. Utilisez filter() pour garder les prix > 20€<br />
                4. Utilisez reduce() pour calculer le total<br />
                5. Chaînez filter + map + reduce en une seule expression<br />
                6. Bonus : Triez les prix par ordre croissant avec sort()
            </p>
            <img src="../img/froggie-300.png" alt="Froggie explain" class="overfrog" id="Froggie" />
        </div>

        <!-- Bouton retour -->
        <a href="index.html" id="goToIndex" title="Retour à l'index">
            <i class="bi bi-arrow-left"></i>
        </a>

        <!-- Lien vers Froggie -->
        <a href="#Froggie">
            <div id="goToFroggie">
                <img src="../img/froggie-300.png" width="50px" /><br /><i class="bi bi-arrow-bar-down"></i>
            </div>
        </a>

        <!-- Footer -->
        <div id="footerGit">
            <a href="https://github.com/eCreafr/DWWM" target="_blank"><i class="bi bi-github">GitHub - eCrea</i></a>
        </div>

        <script>
            // Console JavaScript interactive
            const jsInput = document.getElementById('js-input');
            const jsOutput = document.getElementById('js-output');

            // Exécuter le code
            function executeCode() {
                const code = jsInput.value;
                jsOutput.innerHTML = '';

                // Capturer console.log
                const logs = [];
                const originalLog = console.log;
                console.log = function (...args) {
                    logs.push(args.map(arg =>
                        typeof arg === 'object' ? JSON.stringify(arg, null, 2) : String(arg)
                    ).join(' '));
                    originalLog.apply(console, args);
                };

                try {
                    // Exécuter le code
                    eval(code);

                    // Afficher les logs
                    if (logs.length > 0) {
                        jsOutput.innerHTML = logs.join('\n');
                    } else {
                        jsOutput.innerHTML = '✅ Code exécuté sans erreur (aucune sortie console)';
                    }
                } catch (error) {
                    jsOutput.innerHTML = `<span class="error">❌ Erreur : ${error.message}</span>`;
                } finally {
                    // Restaurer console.log
                    console.log = originalLog;
                }
            }

            // Effacer la console
            function clearConsole() {
                jsInput.value = '';
                jsOutput.innerHTML = 'Console effacée. Prêt à exécuter votre code...';
            }

            // Raccourci clavier Ctrl + Enter
            jsInput.addEventListener('keydown', function (e) {
                if (e.ctrlKey && e.key === 'Enter') {
                    e.preventDefault();
                    executeCode();
                }
            });

            // Exemple au chargement
            window.addEventListener('DOMContentLoaded', function() {
                jsInput.value = `// Traitement de notes d'étudiants
let notes = [12, 15, 8, 18, 9, 14, 16];

// Filtrer les admis (>= 10)
let admis = notes.filter(n => n >= 10);
console.log('Notes admis:', admis);

// Calculer la moyenne
let somme = notes.reduce((acc, n) => acc + n, 0);
let moyenne = somme / notes.length;
console.log('Moyenne:', moyenne.toFixed(2));

// Doubler les notes admises
let doubles = admis.map(n => Math.min(n * 2, 20));
console.log('Notes doublées (max 20):', doubles);`;
            });
        </script>
    </body>
</html>
